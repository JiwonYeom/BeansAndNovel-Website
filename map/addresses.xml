<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="addresses">
	
	
<!-- 배송지 뿌리기 -->
<select id="selectListAddress" parameterType="int" resultType="Address">
SELECT no,address,detailed_address detailedAddress,name,recipient,zipcode,phone,regdate,shipping_address shippingAddress,user_no userNo
FROM addresses	
WHERE user_no=#{userNo}
ORDER BY shippingAddress ASC,name ASC
</select>

<!-- 배송지 삭제 -->
<delete id="deleteAddress" parameterType="int">
DELETE addresses
WHERE no=#{no}
</delete>

<!--  배송지 수정
<UPDATE id="updateAddress" parameterType="Address" resultType="int">
UPDATE addresses SET name=#{name},recipient=#{recipient},zipcode=#{zipcode},address=#{address},detailed_address=#{detailedAddress},phone=#{phone},shipping_address=#{shippingAddress}
WHERE no=#{no}
</UPDATE>-->


<select id="selectOneAddress" parameterType="int" resultType="Address">
SELECT no,address,detailed_address detailedAddress,name,recipient,zipcode,phone,regdate,shipping_address shippingAddress,user_no userNo
FROM addresses
WHERE no=#{no}
</select>

<!-- 기본배송지로 설정 -->
<update id="updateShippingAddress" parameterType="int">
UPDATE addresses SET shipping_address='d'
WHERE no=#{no}
</update>

<!-- 기본배송지로 해제 -->
<update id="updateShippingAddressCancel" parameterType="int">
UPDATE addresses SET shipping_address='n'
WHERE no=#{no}
</update>


<!-- 신태end  -->

<!-- 해인 -->

	<!-- 해당 유저의 주소록 모두 보여주기 -->
	<select id="selectAllAddressesHI" resultType="Address" parameterType="int">
		SELECT no, name, recipient, zipcode, address||detailed_address detailedAddress, phone, shipping_address shippingAddress, regdate, user_no userNo
		FROM addresses
		WHERE user_no=#{userNo} AND shipping_address='n'
	</select>
	
	<!-- 해당 유저의 주소록 보여주기 -->
	<select id="selectOneAddressHI" resultType="Address" parameterType="int">
		SELECT no, name, recipient, zipcode, address||detailed_address address, phone, shipping_address shippingAddress, regdate, user_no userNo
		FROM addresses
		WHERE user_no=#{userNo} AND shipping_address='d'
	</select>
	
<!-- 해인 end -->

<!-- 정배 -->
<insert id="InsertAddressJB" parameterType="Address" >
	INSERT INTO addresses(no,name,recipient,zipcode,address,detailed_address,phone,shipping_address,regdate,user_no)
	VALUES(addresses_seq.nextval,#{name},#{recipient},#{zipcode},#{address},#{detailedAddress},#{phone},#{shippingAddress},systimestamp,#{userNo})
	</insert>
	
	
	<!-- 추가부분 -->
	<update id="updateAddressJW" parameterType="Address">
	UPDATE addresses
	SET name=#{name},recipient=#{recipient},zipcode=#{zipcode},address=#{address},phone=#{phone},shipping_address=#{shippingAddress},regdate=systimestamp
	WHERE no=#{no}
	</update>
	
</mapper>